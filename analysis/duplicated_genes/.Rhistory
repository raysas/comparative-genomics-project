custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
geom_bar_pattern(
stat = "identity",
position = "dodge",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG, pattern = is_TAG)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG, pattern = is_TAG)) +
# geom_bar_pattern(
#   stat = "identity",
#   width = 0.8,
#   color = "white",
#   linewidth = 0.3,
#   pattern_fill = "black",
#   pattern_color = "black",
#   pattern_density = 0.15,
#   pattern_spacing = 0.03,
#   pattern_key_scale_factor = 0.5
# ) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
View(res7)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
this_theme
custom_theme <- theme(
plot.title = element_text( size = 18, hjust = 0.5),
axis.title = element_text( size = 14),
axis.text = element_text(size = 12),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "right",
legend.title = element_text(face = "bold")
)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
custom_theme <- theme(
plot.title = element_text( size = 18, hjust = 0.5),
axis.title = element_text( size = 14),
axis.text = element_text(size = 12),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "right"
)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
#scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(plot_df, aes(x = chromosome, y = count, fill = chromosome, pattern = gene_type)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("duplicated_genes" = "none", "non_duplicated" = "stripe"),
labels = c("duplicated genes", "non-duplicated")) +
labs(title = "total genes vs duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(size_counts_df, aes(x=tag_size, y=count)) +
geom_col(fill = "#ff6f61", color = "white", width = 0.8) +
#geom_line(linewidth = 1, color='#ff9f87') +
geom_point(size = 2) +
geom_text(aes(label = count),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = size_counts_df$tag_size) +
labs(title = "Tandemly Arrayed Genes size distribution (spacer=1)",
x = "TAG size (number of genes)",
y = "number of TAGs") +
this_theme
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_genes)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "Tandemly Arrayed Genes per spacer",
x = "spacer",
y = "number of TAGs genes") +
this_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
y_min <- min(tags_info_df$n_TAG_arrays)
y_max <- max(tags_info_df$n_TAG_arrays)
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
# geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")), vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
ggplot(size_counts_df, aes(x=tag_size, y=count)) +
geom_col(fill = "#ff6f61", color = "white", width = 0.8) +
#geom_line(linewidth = 1, color='#ff9f87') +
geom_point(size = 2) +
geom_text(aes(label = count),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = size_counts_df$tag_size) +
labs(title = "Tandemly Arrayed Genes size distribution (spacer=1)",
x = "TAG size (number of genes)",
y = "number of TAGs") +
this_theme
dup_df<-read.csv('../../output/statistics/duplicated_genes_info.csv')
prot_df<-read.csv('../../output/statistics/protein_info_longest.csv')
edgelist<-read.table('../../output/similarity_edgelists/filtered_blast_results_id30_qcov50_scov50_wcol12_network.tsv')
families_df<-read.table('../../output/clusters/protein_families_filtered_blast_results_id30_qcov50_scov50_wcol12_network.tsv', header=TRUE)
tags_info_df<-read.table('../../output/statistics/TAGs_ratios.tsv', header=TRUE)
tags_df<-read.table('../../output/duplication_classes/TAGS/TAGs_1.tsv', header=TRUE)
colnames(dup_df)
dup_df$chromosome <- factor(dup_df$chromosome)
prot_df$chromosome <- factor(prot_df$chromosome)
dup_full_df <- dup_df[!is.na(dup_df$chromosome) & !is.na(dup_df$start_pos) & !is.na(dup_df$end_pos), ]
# -- sort by chromosome number
dup_df<-dup_df[order(as.numeric(as.character(dup_df$chromosome))), ]
prot_df<-prot_df[order(as.numeric(as.character(prot_df$chromosome))), ]
# -- save those in prot but not in dup
singletons_df<-prot_df[!prot_df$peptide_id %in% dup_df$peptide_id, ]
dim(singletons_df)
singletons_df
dim(singletons_df)
dim(dup_df)
dup_df<-read.csv('../../output/statistics/duplicated_genes_info.csv')
# ------------------ for tags df -------------------------
tags_df<-read.table('../../output/duplication_classes/TAGS/low/TAGs_1.tsv', header=TRUE)
tags_df$tag_id <- ifelse(tags_df$TAG == 0,
0,
paste0(tags_df$family, "_TAG", tags_df$TAG))
# --for every pair having same tag_id, make all combinations
tag_pairs_list <- lapply(unique(tags_df$tag_id[tags_df$tag_id != 0]), function(tid) {
members <- tags_df$peptide_id[tags_df$tag_id == tid]
if (length(members) < 2) return(NULL)
combn(members, 2, FUN = function(x) {
data.frame(
geneA = x[1],
geneB = x[2],
tag_id = tid,
startA = dup_full_df$start_pos[dup_full_df$peptide_id == x[1]],
endA = dup_full_df$end_pos[dup_full_df$peptide_id == x[1]],
strandA= dup_full_df$strand[dup_full_df$peptide_id == x[1]],
startB = dup_full_df$start_pos[dup_full_df$peptide_id == x[2]],
endB = dup_full_df$end_pos[dup_full_df$peptide_id == x[2]],
strandB= dup_full_df$strand[dup_full_df$peptide_id == x[2]],
stringsAsFactors = FALSE
)
}, simplify = FALSE)
})
tag_pairs_df <- do.call(rbind, unlist(tag_pairs_list, recursive = FALSE))
tags_df$tag_id <- ifelse(tags_df$TAG == 0,
0,
paste0(tags_df$family, "_TAG", tags_df$TAG))
dup_full_df<-read.csv('../../duplicated_genes_info_id30_qcov50_scov50_evalue1e-10_wcol12.csv')
dup_full_df <- dup_df[!is.na(dup_df$chromosome) & !is.na(dup_df$start_pos) & !is.na(dup_df$end_pos), ]
dup_df<-read.csv('../../output/info/duplicated_genes_info_id30_qcov50_scov50_evalue1e-10_wcol12.csv')
dup_full_df <- dup_df[!is.na(dup_df$chromosome) & !is.na(dup_df$start_pos) & !is.na(dup_df$end_pos), ]
tags_df$tag_id <- ifelse(tags_df$TAG == 0,
0,
paste0(tags_df$family, "_TAG", tags_df$TAG))
# --for every pair having same tag_id, make all combinations
tag_pairs_list <- lapply(unique(tags_df$tag_id[tags_df$tag_id != 0]), function(tid) {
members <- tags_df$peptide_id[tags_df$tag_id == tid]
if (length(members) < 2) return(NULL)
combn(members, 2, FUN = function(x) {
data.frame(
geneA = x[1],
geneB = x[2],
tag_id = tid,
startA = dup_full_df$start_pos[dup_full_df$peptide_id == x[1]],
endA = dup_full_df$end_pos[dup_full_df$peptide_id == x[1]],
strandA= dup_full_df$strand[dup_full_df$peptide_id == x[1]],
startB = dup_full_df$start_pos[dup_full_df$peptide_id == x[2]],
endB = dup_full_df$end_pos[dup_full_df$peptide_id == x[2]],
strandB= dup_full_df$strand[dup_full_df$peptide_id == x[2]],
stringsAsFactors = FALSE
)
}, simplify = FALSE)
})
tag_pairs_df <- do.call(rbind, unlist(tag_pairs_list, recursive = FALSE))
# -- ordering them by having startA < startB
tag_pairs_df <- tag_pairs_df %>%
rowwise() %>%
mutate(
geneA_final = ifelse(startA < startB, geneA, geneB),
geneB_final = ifelse(startA < startB, geneB, geneA),
startA_final = ifelse(startA < startB, startA, startB),
endA_final = ifelse(startA < startB, endA, endB),
strandA_final = ifelse(startA < startB, strandA, strandB),
startB_final = ifelse(startA < startB, startB, startA),
endB_final = ifelse(startA < startB, endB, endA),
strandB_final = ifelse(startA < startB, strandB, strandA)
) %>%
select(geneA = geneA_final,
geneB = geneB_final,
tag_id,
startA = startA_final,
endA = endA_final,
strandA = strandA_final,
startB = startB_final,
endB = endB_final,
strandB = strandB_final)
View(tags_df)
tags_df$tag_id <- ifelse(tags_df$TAG == 0,
0,
paste0(tags_df$family, "_TAG", tags_df$TAG))
print(count(tags_df$tag_id[tags_df$tag_id != 0]))
print(sum(tags_df$tag_id[tags_df$tag_id != 0]))
count(table(tags_df$tag_id))
(table(tags_df$tag_id))
sum(table(tags_df$tag_id))
sum(table(tags_df$tag_id) > 1) # -- number of TAGs with more than 1 gene
sum(tags_df$TAG == 0) # -- 10555 singletons
sum(tags_df$TAG != 0) # -- 10555 singletons
sum(tags_df$tag_id != 0)
tags_info_df<-read.table('../../output/statistics/TAGs_spacers_ratios_high.tsv', header=TRUE)
tags_df<-read.table('../../output/duplication_classes/TAGs/high/TAGs_1.tsv', header=TRUE)
stringency='high'
tags_info_df<-read.table(paste0('../../output/statistics/TAGs_spacers_ratios_',stringency,'.tsv'), header=TRUE)
tags_df<-read.table(paste0('../../output/duplication_classes/TAGs/',stringency,'/TAGs_1.tsv'), header=TRUE)
library(ggplot2)
theme_set(theme_minimal(base_size = 14))
this_theme<-theme(
plot.title = element_text(size = 18, hjust = 0.5),
axis.title = element_text(size = 14),
axis.text = element_text(size = 8),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "right",
legend.title = element_text(size = 14),
legend.text = element_text(size = 12)
)
y_min <- min(tags_info_df$n_TAG_genes)-1000
y_max <- max(tags_info_df$n_TAG_genes)
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_genes)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "Tandemly Arrayed Genes per spacer",
x = "spacer",
y = "number of TAGs genes") +
this_theme
y_min <- min(tags_info_df$n_TAG_arrays)
y_max <- max(tags_info_df$n_TAG_arrays)
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
# geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")), vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
# -- taking spacer=1
tags_df$tag_id <- ifelse(tags_df$TAG != 0,
paste0(tags_df$family, "_TAG", tags_df$TAG),0)
tag_sizes_df<-as.data.frame(table(tags_df$tag_id))
colnames(tag_sizes_df)<-c('tag_id','size')
tag_sizes_df<- tag_sizes_df %>%
filter(tag_id != 0) %>%
arrange(-size)
size_counts_df<-as.data.frame(table(tag_sizes_df$size))
colnames(size_counts_df)<-c('tag_size','count')
size_counts_df$tag_size<-as.numeric(as.character(size_counts_df$tag_size))
size_counts_df<-size_counts_df %>%
arrange(tag_size)
ggplot(size_counts_df, aes(x=tag_size, y=count)) +
geom_col(fill = "#ff6f61", color = "white", width = 0.8) +
#geom_line(linewidth = 1, color='#ff9f87') +
geom_point(size = 2) +
geom_text(aes(label = count),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = size_counts_df$tag_size) +
labs(title = "Tandemly Arrayed Genes size distribution (spacer=1)",
x = "TAG size (number of genes)",
y = "number of TAGs") +
this_theme
stringency='low'
tags_info_df<-read.table(paste0('../../output/statistics/TAGs_spacers_ratios_',stringency,'.tsv'), header=TRUE)
tags_df<-read.table(paste0('../../output/duplication_classes/TAGs/',stringency,'/TAGs_1.tsv'), header=TRUE)
library(ggplot2)
theme_set(theme_minimal(base_size = 14))
this_theme<-theme(
plot.title = element_text(size = 18, hjust = 0.5),
axis.title = element_text(size = 14),
axis.text = element_text(size = 8),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "right",
legend.title = element_text(size = 14),
legend.text = element_text(size = 12)
)
y_min <- min(tags_info_df$n_TAG_genes)-1000
y_max <- max(tags_info_df$n_TAG_genes)
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_genes)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "Tandemly Arrayed Genes per spacer",
x = "spacer",
y = "number of TAGs genes") +
this_theme
y_min <- min(tags_info_df$n_TAG_arrays)
y_max <- max(tags_info_df$n_TAG_arrays)
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
# geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")), vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
