geom_text(aes(label = count),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = size_counts_df$tag_size) +
labs(title = "Tandemly Arrayed Genes size distribution (spacer=1)",
x = "TAG size (number of genes)",
y = "number of TAGs") +
this_theme
this_theme<-theme(
plot.title = element_text(size = 18, hjust = 0.5),
axis.title = element_text(size = 14),
axis.text = element_text(size = 8),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "right",
legend.title = element_text(size = 14),
legend.text = element_text(size = 12)
)
y_min <- min(tags_info_df$n_TAG_genes)-1000
y_max <- max(tags_info_df$n_TAG_genes)
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_genes)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "Tandemly Arrayed Genes per spacer",
x = "spacer",
y = "number of TAGs genes") +
this_theme
# -- taking spacer=1
tags_df$tag_id <- ifelse(tags_df$TAG != 0,
paste0(tags_df$family, "_TAG", tags_df$TAG),0)
tag_sizes_df<-as.data.frame(table(tags_df$tag_id))
colnames(tag_sizes_df)<-c('tag_id','size')
tag_sizes_df<- tag_sizes_df %>%
filter(tag_id != 0) %>%
arrange(-size)
size_counts_df<-as.data.frame(table(tag_sizes_df$size))
colnames(size_counts_df)<-c('tag_size','count')
size_counts_df$tag_size<-as.numeric(as.character(size_counts_df$tag_size))
size_counts_df<-size_counts_df %>%
arrange(tag_size)
ggplot(size_counts_df, aes(x=tag_size, y=count)) +
geom_col(fill = "#ff6f61", color = "white", width = 0.8) +
#geom_line(linewidth = 1, color='#ff9f87') +
geom_point(size = 2) +
geom_text(aes(label = count),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = size_counts_df$tag_size) +
labs(title = "Tandemly Arrayed Genes size distribution (spacer=1)",
x = "TAG size (number of genes)",
y = "number of TAGs") +
this_theme
# -- dup and tag genes
tags_df<-read.table('../../output/duplication_classes/TAGS/TAGs_1.tsv', header=TRUE)
merged_df
total_counts <- prot_df %>% count(chromosome, name = "total_genes")
dup_counts <- dup_df %>% count(chromosome, name = "duplicated_genes")
dup_counts
dup_df<-read.csv('../../output/statistics/duplicated_genes_info.csv')
dup_df
dup_df<-read.csv('../../output/statistics/duplicated_genes_info.csv')
# -- dup and tag genes
tags_df<-read.table('../../output/duplication_classes/TAGS/TAGs_1.tsv', header=TRUE)
families_df<-read.table('../../output/clusters/protein_families_filtered_blast_results_id30_qcov50_scov50_wcol12_network.tsv', header=TRUE)
dup_df<-read.csv('../../output/statistics/duplicated_genes_info.csv')
families_dup_df <- dup_df %>%
inner_join(families_df, by = c("peptide_id"="geneName"))
families_dup_df
tags_dup_df <- tags_df %>%
inner_join(families_dup_df, by = c("family"="family"))
tags_dup_df <- families_dup_df %>%
left_join(tags_df, by = c("family"="family"))
tags_df
# -- for each peptide_id if it has TAG col> 0 then it is TAG gene => add its tag id as family_TAG to dup
families_dup_df <- families_dup_df %>%
left_join(tags_df %>% select(peptide_id, TAG), by = "peptide_id") %>%
mutate(
is_TAG = ifelse(!is.na(TAG) & TAG != 0, TRUE, FALSE)
)
families_dup_df
# -- for each peptide_id if it has TAG col> 0 then it is TAG gene => add its tag id as family_TAG to dup
families_dup_df <- families_dup_df %>%
left_join(tags_df %>% select(peptide_id, TAG), by = "peptide_id") %>%
mutate(
is_TAG = ifelse(!is.na(TAG) & TAG != 0, TRUE, FALSE),
TAG_id = ifelse(is_TAG, paste0(family, "_TAG", TAG), NA
)
# -- for each peptide_id if it has TAG col> 0 then it is TAG gene => add its tag id as family_TAG to dup
families_dup_df <- families_dup_df %>%
# -- for each peptide_id if it has TAG col> 0 then it is TAG gene => add its tag id as family_TAG to dup
families_dup_df <- families_dup_df %>%
left_join(tags_df %>% select(peptide_id, TAG), by = "peptide_id") %>%
mutate(
is_TAG = ifelse(!is.na(TAG) & TAG != 0, TRUE, FALSE),
TAG_id = ifelse(is_TAG, paste0(family, "_TAG", TAG), NA
) )
# -- for each peptide_id if it has TAG col> 0 then it is TAG gene => add its tag id as family_TAG to dup
families_dup_df <- families_dup_df %>%
left_join(tags_df %>% select(peptide_id, TAG), by = "peptide_id") %>%
mutate(
is_TAG = ifelse(!is.na(TAG) & TAG != 0, TRUE, FALSE),
TAG_id = ifelse(is_TAG, paste0(family, "_TAG", TAG), NA)
)
families_dup_df <- dup_df %>%
inner_join(families_df, by = c("peptide_id"="geneName"))
# -- for each peptide_id if it has TAG col> 0 then it is TAG gene => add its tag id as family_TAG to dup
families_dup_df <- families_dup_df %>%
left_join(tags_df %>% select(peptide_id, TAG), by = "peptide_id") %>%
mutate(
is_TAG = ifelse(!is.na(TAG) & TAG != 0, TRUE, FALSE),
TAG_id = ifelse(is_TAG, paste0(family, "_TAG", TAG), NA)
)
families_tag_dup_df <- dup_df %>%
inner_join(families_df, by = c("peptide_id"="geneName")) %>%
left_join(tags_df %>% select(peptide_id, TAG), by = "peptide_id") %>%
mutate(
is_TAG = ifelse(!is.na(TAG) & TAG != 0, TRUE, FALSE),
TAG_id = ifelse(is_TAG, paste0(family, "_TAG", TAG), NA)
)
# -- distribution of TAG_id and non-TAG duplicated genes per chromosome
tag_dup_counts <- families_tag_dup_df %>%
group_by(chromosome, is_TAG) %>%
summarise(count = n()) %>%
ungroup()
tag_dup_counts$is_TAG <- ifelse(tag_dup_counts$is_TAG, "TAG duplicated genes", "non-TAG duplicated genes")
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = chromosome, pattern = is_TAG)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = chromosome, pattern = is_TAG)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
) +
#scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG, pattern = is_TAG)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3
) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
# -- distribution of TAG_id and non-TAG duplicated genes per chromosome
tag_dup_counts <- families_tag_dup_df %>%
group_by(chromosome, is_TAG) %>%
summarise(count = n()) %>%
ungroup()
tag_dup_counts$is_TAG <- ifelse(tag_dup_counts$is_TAG, "TAG duplicated genes", "non-TAG duplicated genes")
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
geom_bar_pattern(
stat = "identity",
position = "dodge",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG, pattern = is_TAG)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG, pattern = is_TAG)) +
# geom_bar_pattern(
#   stat = "identity",
#   width = 0.8,
#   color = "white",
#   linewidth = 0.3,
#   pattern_fill = "black",
#   pattern_color = "black",
#   pattern_density = 0.15,
#   pattern_spacing = 0.03,
#   pattern_key_scale_factor = 0.5
# ) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("TAG duplicated genes" = "none", "non-TAG duplicated genes" = "stripe")) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
View(res7)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
this_theme
custom_theme <- theme(
plot.title = element_text( size = 18, hjust = 0.5),
axis.title = element_text( size = 14),
axis.text = element_text(size = 12),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "right",
legend.title = element_text(face = "bold")
)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG duplicated genes vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
custom_theme <- theme(
plot.title = element_text( size = 18, hjust = 0.5),
axis.title = element_text( size = 14),
axis.text = element_text(size = 12),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "right"
)
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
#scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(plot_df, aes(x = chromosome, y = count, fill = chromosome, pattern = gene_type)) +
geom_bar_pattern(
stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3,
pattern_fill = "black",
pattern_color = "black",
pattern_density = 0.15,
pattern_spacing = 0.03,
pattern_key_scale_factor = 0.5
) +
scale_fill_manual(values = chrom_colors) +
scale_pattern_manual(values = c("duplicated_genes" = "none", "non_duplicated" = "stripe"),
labels = c("duplicated genes", "non-duplicated")) +
labs(title = "total genes vs duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "chromosome", pattern = "gene type") +
base_theme +
custom_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(size_counts_df, aes(x=tag_size, y=count)) +
geom_col(fill = "#ff6f61", color = "white", width = 0.8) +
#geom_line(linewidth = 1, color='#ff9f87') +
geom_point(size = 2) +
geom_text(aes(label = count),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = size_counts_df$tag_size) +
labs(title = "Tandemly Arrayed Genes size distribution (spacer=1)",
x = "TAG size (number of genes)",
y = "number of TAGs") +
this_theme
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_genes)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "Tandemly Arrayed Genes per spacer",
x = "spacer",
y = "number of TAGs genes") +
this_theme
ggplot(tag_dup_counts, aes(x = chromosome, y = count, fill = is_TAG)) +
geom_bar(stat = "identity",
width = 0.8,
color = "white",
linewidth = 0.3) +
scale_fill_manual(values = chrom_colors) +
labs(title = "TAG vs non-TAG duplicated genes per chromosome",
x = "chromosome", y = "gene count",
fill = "duplicated gene type") +
base_theme +
custom_theme
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
y_min <- min(tags_info_df$n_TAG_arrays)
y_max <- max(tags_info_df$n_TAG_arrays)
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
ggplot(tags_info_df, aes(x = spacer, y = n_TAG_arrays)) +
geom_col(fill = "#007ea7", color = "white", width = 0.8) +
geom_line(linewidth = 1, color='#00a8e8') +
geom_point(size = 2) +
# geom_text(aes(label = paste0(round(ratio_TAG_genes, 3)*100, "%")), vjust = -0.5, size = 4) +
scale_x_continuous(breaks = tags_info_df$spacer) +
coord_cartesian(ylim = c(y_min, y_max)) +
labs(title = "TAGs arrays per spacer",
x = "spacer",
y = "number of TAGs arrays") +
this_theme
ggplot(size_counts_df, aes(x=tag_size, y=count)) +
geom_col(fill = "#ff6f61", color = "white", width = 0.8) +
#geom_line(linewidth = 1, color='#ff9f87') +
geom_point(size = 2) +
geom_text(aes(label = count),
vjust = -0.5, size = 4) +
scale_x_continuous(breaks = size_counts_df$tag_size) +
labs(title = "Tandemly Arrayed Genes size distribution (spacer=1)",
x = "TAG size (number of genes)",
y = "number of TAGs") +
this_theme
