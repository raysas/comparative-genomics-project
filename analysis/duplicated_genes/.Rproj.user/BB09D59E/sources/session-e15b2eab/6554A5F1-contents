library(ggplot2)

dup_df<-read.csv('../../output/statistics/duplicated_genes_info.csv')
prot_df<-read.csv('../../output/statistics/protein_info_longest.csv')

colnames(dup_df)
dup_df$chromosome <- factor(dup_df$chromosome)

# -- distribution of duplicated genes by chromosome (stacked bar plot)

ggplot(dup_df, aes(x = chromosome, fill = chromosome)) +
  geom_bar(position = "stack") +
  labs(
    title = "Distribution of Duplicated Genes by Chromosome",
    x = "Chromosome",
    y = "Number of Duplicated Genes"
  ) +
  theme_minimal()

ggplot(dup_df, aes(x = "", fill = chromosome)) +
  geom_bar(width = 1) +
  coord_polar(theta = "y") +
  labs(
    title = "Distribution of Duplicated Genes by Chromosome",
    x = NULL,
    y = NULL
  ) +
  theme_minimal()



# -- circos plot
library(circlize)

# Prepare data for circos plot
dup_pairs <- dup_df[, c("gene_id", "chromosome", "start_pos", "end_pos")]

# Initialize circos plot
circos.clear()
circos.par("track.height" = 0.1)
circos.initialize(factors = dup_pairs$chromosome, xlim = cbind(dup_pairs$start_pos, dup_pairs$end_pos))


# -- genomicRanges
BiocManager::install("GenomicRanges")
library(GenomicRanges)
# Create GRanges object for duplicated genes
dup_gr <- GRanges(seqnames = dup_df$chromosome,
                  ranges = IRanges(start = dup_df$start_pos, end = dup_df$end_pos),
                  gene_id = dup_df$peptide_id)
